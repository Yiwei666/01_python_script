# 1. 项目功能


1. 两相从头算分子动力学模拟轨迹文件后处理分析
2. LCSC分离模型的代码实现
3. ISAACS配位数据后处理分析
4. 硅-硅酸盐熔体杂质元素分配比计算




# 2. 项目文件结构

**背景**：在使用ISAACS分析硅-硅酸盐两相从头算输出的原子轨迹时，为了计算某种原子X的局域结构，通常会设置 X-O 以及 X-Si 截断半径，使其输出的配位结构中只包含这两类原子，从而基于这两类原子的相对比例判断其所属相

- 01_配位结构分析(isaacs数据后处理).py

```
1. 初始版本，忽略空行和 # 开头行
2. 筛选并打印第二列数据为0的行，通常需要注意第二列数据的原子种类，判断是否为Si或者O
3. 打印倒数第二列数据和倒数第四列数据的求和
4. 按照倒数第二列数据递减的顺序打印行
```

  
- 02_界面及体相配位结构分析(isaacs数据后处理).py  

```
1. 筛选位于两相以及界面的行数，可自定义Si和O种类原子所在的列数。
2. 对每一部分的原子数以及百分比进行求和，即倒数第二列、四列数据的求和
3. 按照倒数第二列数据递减的顺序打印
```


- 03_界面原子分割计算.py

```
1. 提示输入 "请输入O配位数所在列数，Si配位数所在列数，渣中X-O平均配位数，硅中X-Si平均配位数，用英文逗号隔开"
2. 返回位于硅相，硅酸盐相以及界面处的行，相应X原子数以及百分比
3. 返回考虑界面分割后的硅相X原子数以及渣相X原子数
```

- 06_X-O两相平均配位数及杂质原子两相分布和平均氧化程度k计算.py

```
功能：基于ISAACS输出的包含有X-O和X-Si配位信息的txt文件，计算两相共存体系中X的平均X-O配位数，X的平均氧化程度，分配到硅相和硅酸盐相中的X原子数量

1. 请输入要处理的文件名：V_twophase.txt
2. 请输入氧原子所在的列，从1开始计数，氧(O)原子通常位于第2列: 2
3. 请输入浮点数：硅酸盐中X-O平均配位数y_CN_SilicateAve, 两相中总的杂质原子数z_total_Nx（用英文逗号分隔）: 4.32,8
```

上述4个脚本处理的数据文本结构如下，忽略#字开头行以及空行
该数据文本通过ISAACS对xyz轨迹文件进行分析而获取的，在计算配位环境的时候设置X-O为r_cutoff1，设置X-Si为r_cutoff2，如果N(O)列为0，则代表配位环境中没有O；如果N(Si)列为0，则代表配位环境中没有Si；同时都不为0，则代表配位环境中Si和O都存在。
```
# Environments for P  atoms:

# N(tot)   N(O )   N(Si)   N(P )   N(Ca)          Number   or     Percent
  4        0       4       0       0           0.63576   or       7.947 %
  2        1       1       0       0           0.54967   or       6.871 %
  3        0       3       0       0           3.29139   or      41.142 %
  4        3       1       0       0           0.70199   or       8.775 %
  5        1       4       0       0           0.02649   or       0.331 %
  3        2       1       0       0           0.46358   or       5.795 %
  
```

- 04_LCSC分离模型(B分配计算).py

04_LCSC分离模型.py 脚本用于计算分配比，计算时需要设置初始两相的原子数，杂质原子的相对原子质量，模拟平衡后杂质原子在硅相中的原子数


- 05_分配比与两相平均配位数和渣相配位数关系.py

05_分配比与两相平均配位数和渣相配位数关系脚本基于 两相X-O平均配位数 / 渣相X-O平均配位数 来计算分配比，通过该比值可以计算两相模拟平衡后进入到渣相的杂质原子数（或剩余在硅相的杂质原子数）进而计算出分配比


# 3. 从头算分子动力学模拟

### 1. 预处理

1. 理论计算，确定原子种类和个数，各类元素质量占比。闭壳层体系下注意整个体系的电子数务必为偶数。

2. 基于Factsage和密度参数列表计算密度等物性参数，确定模拟的绝对温度(注意绝对温度和摄氏温度换算)。

3. 使用`Material Studio`建模，注意MS建模中`温度`和`密度`参数设置，导出`.cell`文件，使用`ovito`转化为`.xyz`文件。


### 2. cp2k的inp控制文件和超算提交

1. 设置inp文件。盒子边长，赝势基组，全局变量，控温方式，初末绝对温度，系综，截断能，步长。

2. 收敛性测试。注意针对金属体系，采用对角化方法，其余采用OT算法。一般在进行大规模计算之前，需要对体系的收敛性进行测试。

3. 如果是指数降温，需要基于初末温度和步数确定降温系数k = (T末/T初)^(1/步数)，一般在0.999~1之间。

4. 超算上传并提交计算文件。打开WinSCP，在超算中新建文件夹，上传计算文件，一共是5个文件。 dftd3.dat、GTH_POTENTIALS、OT.inp、SiTiBAl.xyz、sub.sh。

5. 查看.out文件，确认任务是否正常进行。















