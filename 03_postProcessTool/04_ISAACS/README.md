# 1. 项目功能



# 2. 文件结构

```
01_删除当前目录下无后缀ISAACS导出文件中的表头行.py
02_基于ISAACS配位原子数百分比提取.py
03_B-O配位数同时为3和4的聚合度分析.py
04_含Al掺杂的B最近邻和次近邻聚合度分析.py
05_将空格分隔的列数据保存到excel文件.py
```



# 3. 环境配置

### 1. `01_删除当前目录下无后缀ISAACS导出文件中的表头行.py`

1. 功能概述：

该代码的目的是在当前目录下查找没有文件后缀的文件，读取这些文件的内容，并删除文件中以 `@` 开头的行，然后将处理后的内容保存到一个新文件中。新文件的命名格式为原文件名加上 `origin_` 前缀。

2. 主要步骤：
    - 文件筛选：使用 `os.listdir('.')` 获取当前目录下的所有文件，筛选出没有文件后缀的文件。
    - 处理文件内容：对于每一个没有文件后缀的文件，打开文件并逐行读取。如果某一行不是以 `@` 开头，则将该行写入一个新文件。
    - 新文件保存：新文件的命名是将原文件的名称加上前缀 `origin_`，并将处理后的内容保存到该新文件中。

通过该方式获取到的数据文件可以：1. 复制粘贴到origin中绘图，2. 使用python脚本快速绘图获取截断半径，用于ISAACS后续的`bond properties`分析。


### 2. `02_基于ISAACS配位原子数百分比提取.py`

1. 待处理的数据示例（通常由ISAACS分析xyz轨迹文件得出）：

`example_rawdata.txt`

```
#Environments for Pt atoms:

#N(tot)   N(O )   N(Si)   N(Ca)   N(Pt)          Number   or     Percent
  4        4       0       0       0           5.50993   or      68.874 %
  5        5       0       0       0           0.77483   or       9.685 %
  3        3       0       0       0           1.29139   or      16.142 %
  2        2       0       0       0           0.42384   or       5.298 %
```

2. 功能：
    - 列出当前目录下的所有文件。
    - 读取用户指定的文件，跳过前三行，并提取第一列和倒数第二列的数据。
    - 将数据按第一列排序后输出。通常适用于最近邻配位结构，且配位原子仅有一种，特别是硅酸盐渣中 X-O 的配位结构统计分析。



### 3. `03_B-O配位数同时为3和4的聚合度分析.py`

1. 总体思路

```
请按照以下要求编写python代码，给出完整代码

读取脚本所在目录下的 B_isaacs.txt 数据文件，忽略前3行，其余数据（定义为数据集a0）分为若干列， 列和列之间使用空格分隔，进行如下计算：
打印出a0数据集
计算a0数据集第6列数据的和t1和第8列数据的和t2（浮点数计算），打印出来
从a0数据集中提取第5列数值为3的行（定义为a1数据集），分别计算这些行第6列数据的和x1和第8列数据的和x2（浮点数计算），打印出来；
从a0数据集中提取第5列数值为4的行（定义为b1数据集），分别计算这些行第6列数据的和y1和第8列数据的和y2（浮点数计算），打印出来；
然后分别计算a1数据集中每一行第2列和第3列数的加和az1，再选取其中 az1 小于等于3的行（定义为数据集a2），打印出来；
然后分别计算b1数据集中每一行第2列和第3列数的加和bz1，再选取其中 bz1 小于等于4的行（定义为数据集b2），打印出来；
然后分别计算数据集a2第6列数据的和x3和第8列数据的和x4（浮点数计算），打印出来，再计算并打印x1-x3和x2-x4的值；
然后分别计算数据集b2第6列数据的和y3和第8列数据的和y4（浮点数计算），打印出来，再计算并打印y1-y3和y2-y4的值；
定义k0=(x3+y3)/t1，打印出k0，打印出x3+y3，打印出x4+y4；
定义k1=x3/(x3+y3)，k2=y3/(x3+y3)，打印出 k1和k2；
再从数据集a2中选取第2列和第3列数的加和az1分别为0，1，2，3的行，分别标记为ac0，ac1，ac2，ac3数据集，分别计算这些数据集中第6列数据的和as0，as1，as2，as3，打印出这些和。计算并打印出 as0+as1+as2+as3的和；
再从数据集b2中选取第2列和第3列数的加和bz1分别为0，1，2，3，4的行，分别标记为bc0，bc1，bc2，bc3，bc4数据集，分别计算这些数据集中第6列数据的和bs0，bs1，bs2，bs3，bs4，打印出这些和。计算并打印出 bs0+bs1+bs2+bs3+bs4 的和。
分别打印出ac0，ac1，ac2，ac3数据集和bc0，bc1，bc2，bc3，bc4数据集。
然后计算并打印as0/x3*100%，as1/x3*100%，as2/x3*100%，as3/x3*100%的值，小数点后保留2位有效数字。计算并打印出这几个百分比的求和。
然后计算并打印bs0/y3*100%，bs1/y3*100%，bs2/y3*100%，bs3/y3*100%，bs4/y3*100%的值，小数点后保留2位有效数字。计算并打印出这几个百分比的求和。
然后计算并打印as0/(x3+y3)*100%，as1/(x3+y3)*100%，as2/(x3+y3)*100%，as3/(x3+y3)*100%的值，小数点后保留2位有效数字。计算并打印出这几个百分比的求和。
然后计算并打印bs0/(x3+y3)*100%，bs1/(x3+y3)*100%，bs2/(x3+y3)*100%，bs3/(x3+y3)*100%，bs4/(x3+y3)*100%的值，小数点后保留2位有效数字。计算并打印出这几个百分比的求和。
将a2和b2数据集中每一行第6列数据替换成原数据/k0，第8列数据替换成原数据/k0，小数点后保留3位有效数字，得到的新数据集分别定义为a3和b3。分别打印出数据集a3和b3。
然后分别计算数据集a3第6列数据的和x5和第8列数据的和x6（浮点数计算），打印出来。
然后分别计算数据集b3第6列数据的和y5和第8列数据的和y6（浮点数计算），打印出来。

注意：
x6=k1*100%
y6=k2*100%
x3=as0+as1+as2+as3
y3=bs0+bs1+bs2+bs3+bs4
```

2. 待处理的数据示例（通常由ISAACS分析xyz轨迹文件得出）：

`B_isaacs.txt`

```
Environments for B  atoms:

N(tot)   N(Si)   N(B )   N(Ca)   N(O )          Number   or     Percent
  8        4       0       0       4          35.05000   or      19.691 %
  8        3       1       0       4           2.05000   or       1.152 %
  7        4       0       0       3           5.20000   or       2.921 %
  6        3       0       0       3          29.71000   or      16.691 %
  5        1       1       0       3           1.24000   or       0.697 %
  6        2       1       0       3           1.37000   or       0.770 %
  7        3       0       0       4          32.26000   or      18.124 %
  4        1       0       0       3          17.99000   or      10.107 %
  5        2       0       0       3          34.32000   or      19.281 %
  6        2       0       0       4          10.24000   or       5.753 %
  3        0       0       0       3           1.75000   or       0.983 %
  7        2       1       0       4           1.75000   or       0.983 %
  6        1       1       0       4           0.27000   or       0.152 %
  9        5       0       0       4           0.91000   or       0.511 %
  5        1       0       0       4           2.09000   or       1.174 %
  7        3       1       0       3           0.57000   or       0.320 %
  8        5       0       0       3           0.40000   or       0.225 %
  9        4       1       0       4           0.04000   or       0.022 %
  4        0       1       0       3           0.34000   or       0.191 %
  8        2       2       0       4           0.21000   or       0.118 %
  4        0       0       0       4           0.07000   or       0.039 %
  5        0       1       0       4           0.02000   or       0.011 %
  8        4       1       0       3           0.03000   or       0.017 %
  7        1       2       0       4           0.05000   or       0.028 %
  6        1       2       0       3           0.02000   or       0.011 %
  5        0       2       0       3           0.02000   or       0.011 %
  6        0       2       0       4           0.01000   or       0.006 %
 10        6       0       0       4           0.01000   or       0.006 %
  7        2       2       0       3           0.01000   or       0.006 %
```


### 4. `04_含Al掺杂的B最近邻和次近邻聚合度分析.py`

1. 总体思路

```
请按照以下要求编写python代码，给出完整代码
赋值 col6 = 6，col8 = 8，col5 = 5，colist=[2, 3]
读取脚本所在目录下的 B_isaacs.txt 数据文件，忽略前3行，其余数据（定义为数据集a0）分为若干列， 列和列之间使用空格分隔，进行如下计算：
打印出a0数据集
计算a0数据集第col6列数据的和t1和第col8列数据的和t2（浮点数计算），打印出来
从a0数据集中提取第col5列数值为3的行（定义为a1数据集），分别计算这些行第col6列数据的和x1和第col8列数据的和x2（浮点数计算），打印出来；
从a0数据集中提取第col5列数值为4的行（定义为b1数据集），分别计算这些行第col6列数据的和y1和第col8列数据的和y2（浮点数计算），打印出来；
然后分别计算a1数据集中每一行指定列(数组colist中列出的所有列)数的加和az1，再选取其中 az1 小于等于3的行（定义为数据集a2），打印出来；
然后分别计算b1数据集中每一行指定列(数组colist中列出的所有列)数的加和bz1，再选取其中 bz1 小于等于4的行（定义为数据集b2），打印出来；
然后分别计算数据集a2第col6列数据的和x3和第col8列数据的和x4（浮点数计算），打印出来，再计算并打印x1-x3和x2-x4的值；
然后分别计算数据集b2第col6列数据的和y3和第col8列数据的和y4（浮点数计算），打印出来，再计算并打印y1-y3和y2-y4的值；
定义k0=(x3+y3)/t1，打印出k0，打印出x3+y3，打印出x4+y4；
定义k1=x3/(x3+y3)，k2=y3/(x3+y3)，打印出 k1和k2；
再从数据集a2中选取指定列(数组colist中列出的所有列)数的加和az1分别为0，1，2，3的行，分别标记为ac0，ac1，ac2，ac3数据集，分别计算这些数据集中第col6列数据的和as0，as1，as2，as3，打印出这些和。计算并打印出 as0+as1+as2+as3的和；
再从数据集b2中选取指定列(数组colist中列出的所有列)数的加和bz1分别为0，1，2，3，4的行，分别标记为bc0，bc1，bc2，bc3，bc4数据集，分别计算这些数据集中第col6列数据的和bs0，bs1，bs2，bs3，bs4，打印出这些和。计算并打印出 bs0+bs1+bs2+bs3+bs4的和。
分别打印出ac0，ac1，ac2，ac3数据集和bc0，bc1，bc2，bc3，bc4数据集。
然后计算并打印as0/x3*100%，as1/x3*100%，as2/x3*100%，as3/x3*100%的值，小数点后保留2位有效数字。计算并打印出这几个百分比的求和。
然后计算并打印bs0/y3*100%，bs1/y3*100%，bs2/y3*100%，bs3/y3*100%，bs4/y3*100%的值，小数点后保留2位有效数字。计算并打印出这几个百分比的求和。
然后计算并打印as0/(x3+y3)*100%，as1/(x3+y3)*100%，as2/(x3+y3)*100%，as3/(x3+y3)*100%的值，小数点后保留2位有效数字。计算并打印出这几个百分比的求和。
然后计算并打印bs0/(x3+y3)*100%，bs1/(x3+y3)*100%，bs2/(x3+y3)*100%，bs3/(x3+y3)*100%，bs4/(x3+y3)*100%的值，小数点后保留2位有效数字。计算并打印出这几个百分比的求和。
将a2和b2数据集中每一行第col6列数据替换成原数据/k0，第col8列数据替换成原数据/k0，小数点后保留3位有效数字，得到的新数据集分别定义为a3和b3。分别打印出数据集a3和b3，。
然后分别计算数据集a3第col6列数据的和x5和第col8列数据的和x6（浮点数计算），打印出来。
然后分别计算数据集b3第col6列数据的和y5和第col8列数据的和y6（浮点数计算），打印出来。
```

2. 体系中不含Al体系（CaO-SiO2-B2O3）

```
Environments for B  atoms:

N(tot)   N(Si)   N(B )   N(Ca)   N(O )          Number   or     Percent
  8        4       0       0       4          35.05000   or      19.691 %
  8        3       1       0       4           2.05000   or       1.152 %
  7        4       0       0       3           5.20000   or       2.921 %
  6        3       0       0       3          29.71000   or      16.691 %
```

- 环境变量

```py
# 定义变量，将列数转换为索引
# Number，B原子数所在列，该列求和为体系所有B原子数
col6 = 6 - 1                
# Percent，百分比所在列
col8 = 8 - 1
# N(O )，O原子配位数所在列
col5 = 5 - 1
# N(Si)   N(B ) 等所在列，修改列表 [2, 3]
colist = [c - 1 for c in [2, 3]]  # 列数转为索引
```

需要修改的环境变量包括 `Number Percent O` 以及 `Si B` 所在的列数

3. 体系中含Al体系（CaO-SiO2-Al2O3-B2O3）

```
Environments for B  atoms:

N(tot)   N(Si)   N(Al)   N(B )   N(Ca)   N(O )          Number   or     Percent
  6        3       0       0       0       3           8.88000   or       9.867 %
  6        0       1       1       0       4           0.01000   or       0.011 %
  5        2       0       0       0       3          14.99000   or      16.656 %
  7        3       0       0       0       4          10.28000   or      11.422 %
  8        4       0       0       0       4          10.60000   or      11.778 %
```

- 环境变量

```py
# 定义cluster字典，键为元素符号，值为对应的列数（列数等于列的索引+1）
cluster = {"Si": 2, "Al": 3, "B": 4, "O": 6}

# 定义变量，将列数转换为索引
# Number，B原子数所在列，该列求和为体系所有B原子数
col6 = 7 - 1                
# Percent，百分比所在列
col8 = 9 - 1
# N(O )，O原子配位数所在列
col5 = 6 - 1
# N(Si)   N(B ) 等所在列，修改列表 [2, 3]
colist = [c - 1 for c in [2, 3, 4]]  # 列数转为索引
```

需要修改的环境变量包括 `Number, Percent, O` 以及 `Si, Al, B` 所在的列数


### 5. `05_将空格分隔的列数据保存到excel文件.py`

- 功能：读取脚本所在目录下的 `B_isaacs.txt` 数据文件，忽略前三行，剩下的数据包含若干列，列和列之间使用空格分隔，将剩余数据写入到 `B_isaacs.xlsx` 数据文件中，使得txt文件中的每列数据在xlsx文件中也为1列。

```py
import pandas as pd

# 读取B_isaacs.txt文件，跳过前3行，并指定空格作为分隔符
df = pd.read_csv('B_isaacs.txt', sep='\s+', skiprows=3, header=None)

# 将数据写入B_isaacs.xlsx文件
df.to_excel('B_isaacs.xlsx', index=False, header=False)

print("数据已成功写入B_isaacs.xlsx文件。")
```







