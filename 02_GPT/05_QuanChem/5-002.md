# Multiwfn使用限制

# 1. 注意事项   

1. Multiwfn波函数分析没有考虑`K点采样`，因此cp2k计算时推荐采用`gamma点`计算，单胞的尺寸要足够大来避免K点采样的需求。具体参考手册3.8版本的`p52`页。  


2. 一些波函数分析方法，如`Mayer键级分析、Mulliken键级分析`等，不能够采用含有`弥散函数`（diffuse functions）的基组，否则计算结果不准确。`DZVP-GTH-PBE`不推荐采用，可以采用`MOLOPT-SR-GTH`系列基组。具体参考手册3.8版本的`p52`页，即带有SR的。（`DZVP-MOLOPT-SR-GTH基组`: 适用于固体计算，其中`“SR”`表示较短的范围，意味着更少的`弥散性基函数`，适合`固体`材料。）    

<p align="center">
<img src="https://19640810.xyz/05_image/01_imageHost/20240711-105201.png" alt="Image Description" width="700">
</p>


3. 如果要使用的波函数分析实函数依赖于基函数信息，则不推荐CP2K中设置使用全电子基组，因为与代表核电子基函数相关的重叠积分无法基于均匀网格进行良好评估（见上文）。具体参考手册3.8版本的p51页。   


4. 通常molden文件中没有像wfn或者fch文件那样记录`核电荷（nuclear charges）`，因此依赖于核电荷的波函数分析，如`静电势`，在采用`赝势`进行计算时会出现问题。通过在molden文件的开头插入`[Nval]`小节来确定各元素的价电子能够解决该问题。具体参考手册3.8版本的2.5小节输入文件和波函数类型，p16页。   

<p align="center">
<img src="https://19640810.xyz/05_image/01_imageHost/20240711-160649.png" alt="Image Description" width="700">
</p>


5. Multiwfn支持的实空间函数可以参考手册3.8版本的p6。Multiwfn引用信息参考p8。Multiwfn在windows下的使用参考p12。Multiwfn的并行计算参考p13，2.4小节。关于实空间函数的具体定义可以参考2.6小节，p20页。用户自定义的实空间函数可以参考2.7小节，p32。关于图的类型和尺寸设置可以参考2.8小节，p47页。关于周期性体系的波函数分析可以参考2.9小节，p47页。     

6. pdf文件的页数=手册的页数+20   


7. 关于态密度曲线绘制可以参考3.12小节，p125。由于采用OT算法输出的molden文件里只有占据轨道信息，对于原子电荷计算、Mayer键级计算、IRI/IGMH分析等只依赖于占据轨道信息的分析是足够的，但没法用于涉及到空轨道的分析，如电子激发分析、空轨道图形可视化、绘制DOS（涉及费米能级以上区域时）等。相关解决方案可参考[http://sobereva.com/651。](http://sobereva.com/651%E3%80%82)   


8. 使用Multiwfn批量处理任务，可以参考手册5.2和5.3小节，p1017，以及博客http://sobereva.com/612    

9. cp2k中一般常用的基组文件位于 `cp2k-master\data\BASIS_MOLOPT` 文件中。  


10. 双击启动 Multiwfn 软件，或者在cmd命令行窗口输入`multiwfn`同样能够启动。按`Enter`键可以在GUI窗口中选择载入的文件。按`o`可以重载上次使用的文件。


# 2. 弱相互作用分析相关

### 1. NCI 分析

1. CP2K产生的molden文件还不能直接用于做周期性体系的NCI分析，因为标准的molden格式里没有晶胞信息。为了能让molden文件给Multiwfn提供晶胞信息，我给molden格式做了扩展，定义了[Cell]字段。参考：http://sobereva.com/588

2. 如今CP2K计算普遍使用`MOLOPT基组`，但由于Multiwfn未对`广义收缩基组`优化，使用该基组会导致计算耗时较高。建议使用`6-31G*、6-311G**`等片段收缩的全电子基组进行`GAPW`单点计算，以获得NCI分析用的`molden文件`，能显著降低耗时。此外，`全电子基组相`比MOLOPT赝势基组还能明确表达内核电子，而NCI分析对基组不敏感，使用`6-31G*`通常已足够。参考：http://sobereva.com/588








# 参考资料









